package net.akouryy.kreins
package scorer

import game.{Board, Panel}

object CellScorer extends Scorer {
  /**
    * https://web.archive.org/web/20181106153744/http://www.geocities.co.jp/SiliconValley-Bay/4543/Osero/Value/Value-2.html
    */
  def panelScore(panel: Panel) = {
    val c = panel.code
    // @formatter:off
    (
      (c >>  0 & 1) *  45 + (c >>  1 & 1) * -16 + (c >>  2 & 1) *   4 + (c >>  3 & 1) *  -1
    + (c >>  4 & 1) *  -1 + (c >>  5 & 1) *   4 + (c >>  6 & 1) * -16 + (c >>  7 & 1) *  45
    + (c >>  8 & 1) * -16 + (c >>  9 & 1) * -21 + (c >> 10 & 1) *  -1 + (c >> 11 & 1) *  -3
    + (c >> 12 & 1) *  -3 + (c >> 13 & 1) *  -1 + (c >> 14 & 1) * -21 + (c >> 15 & 1) * -16
    + (c >> 16 & 1) *   4 + (c >> 17 & 1) *  -1 + (c >> 18 & 1) *   2 + (c >> 19 & 1) *  -1
    + (c >> 20 & 1) *  -1 + (c >> 21 & 1) *   2 + (c >> 22 & 1) *  -1 + (c >> 23 & 1) *   4
    + (c >> 24 & 1) *  -1 + (c >> 25 & 1) *  -3 + (c >> 26 & 1) *  -1 + (c >> 27 & 1) *   0
    + (c >> 28 & 1) *   0 + (c >> 29 & 1) *  -1 + (c >> 30 & 1) *  -3 + (c >> 31 & 1) *  -1
    + (c >> 32 & 1) *  -1 + (c >> 33 & 1) *  -3 + (c >> 34 & 1) *  -1 + (c >> 35 & 1) *   0
    + (c >> 36 & 1) *   0 + (c >> 37 & 1) *  -1 + (c >> 38 & 1) *  -3 + (c >> 39 & 1) *  -1
    + (c >> 40 & 1) *   4 + (c >> 41 & 1) *  -1 + (c >> 42 & 1) *   2 + (c >> 43 & 1) *  -1
    + (c >> 44 & 1) *  -1 + (c >> 45 & 1) *   2 + (c >> 46 & 1) *  -1 + (c >> 47 & 1) *   4
    + (c >> 48 & 1) * -16 + (c >> 49 & 1) * -21 + (c >> 50 & 1) *  -1 + (c >> 51 & 1) *  -3
    + (c >> 52 & 1) *  -3 + (c >> 53 & 1) *  -1 + (c >> 54 & 1) * -21 + (c >> 55 & 1) * -16
    + (c >> 56 & 1) *  45 + (c >> 57 & 1) * -16 + (c >> 58 & 1) *   4 + (c >> 59 & 1) *  -1
    + (c >> 60 & 1) *  -1 + (c >> 61 & 1) *   4 + (c >> 62 & 1) * -16 + (c >> 63 & 1) *  45
    )
    // @formatter:on
  }

  def score(board: Board) =
    (panelScore(board.fst) - panelScore(board.snd)).toInt
}
